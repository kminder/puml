@startuml
title Secure Map Reduce 2 - Application Container Token Flow
autonumber
'hide footbox

'participant "Client\n(c)" as C
participant "Resource\nManager\n(rm)" as RM
'participant "History\nServer\n(hs)" as HS
participant "Node\nManager\n(nm)" as NM
'participant "Shuffle\nService\n(ss)" as SS
participant "Application\nMaster\n(am)" as AM
'participant "Client\nService\n(cs)" as CS
'participant "Application\nContainer\n(ac)" as AC #red
'participant "Task\n(t)" as T #orange
'participant "File\nSystem\n(fs)" as FS
'participant "Name\nNode\n(nn)" as NN
'participant "Data\nNode\n(dn)" as DN
'participant "Kerberos\nKDC" as KDC

'note over C,KDC #green: QUESTION ?

== Bootstrap ==
RM->RM:<b>createAppContainerTokenSecretKey()\n : ac-tkn-sk
NM->RM:<b>register/heartbeat\n [RSKT(nm-rm-kst)]\n ( nm-status )\n : nm-tkn-sk, ac-tkn-sk

== Job Definition ==

== Job Submission ==

== Job Initiation ==
RM->RM: <b>allocateResource\n ( mr-rsrc-req )\n : mr-rsrc-res{nm-tkn,ac-tkn}
RM->RM: <b>createApplicationContainerToken\n ( ac-tkn-sk )\n : ac-tkn

== Map Task Execution ==
AM->RM: <b>allocateResources\n [RSAT(am-tkn)]\n ( mt-container-req )\n : mt-container-res{nm-tkn,ac-tkn}

== Reduce Task Execution ==

== Job Completion ==

@enduml